function [ zk,q] = run_manip( z,tau,q,dt)

[T,Y] = ode15s(@dynsystemoftheuvms,[0 dt],[z(1),z(2),z(3),z(4),q(1),q(2),q(3),q(4),tau(1),tau(2),tau(3),tau(4)]);

zk(1,1)=Y(end,1);
zk(2,1)=Y(end,2);
zk(3,1)=Y(end,3);
zk(4,1)=Y(end,4);



q(1,1)=Y(end,5);
q(2,1)=Y(end,6);
q(3,1)=Y(end,7);
q(4,1)=Y(end,8);

end


function  dy = dynsystemoftheuvms(t,y)
dynamic_param;
q_d1=y(1);
q_d2=y(2);
q_d3=y(3);
q_d4=y(4);


q1=y(5);
q2=y(6);
q3=y(7);
q4=y(8);


Z=[q_d1,q_d2,q_d3,q_d4]';



tau=[y(9),y(10),y(11),y(12)]';
% It is from manipulator.mat 

M =[I2a + I1b + I3c + I4c + (I4a*sin(q2 + q3 + q4)^2)/4 - (I4b*sin(q2 + q3 + q4)^2)/4 + (L2^2*m1)/4 + L2^2*m2 + L2^2*m3 + L2^2*m4 + (L4^2*m3)/4 + L4^2*m4 + (I4a*sin(q2 + q3 - q4)^2)/4 - (I4b*sin(q2 + q3 - q4)^2)/4 + I3a*sin(q2 + q3)^2 + (I4a*sin(q2 + q3)^2)/2 + (I4b*sin(q2 + q3)^2)/2 - I3c*sin(q2 + q3)^2 - I4c*sin(q2 + q3)^2 - I2a*sin(q2)^2 - (I4a*sin(q4)^2)/2 + I2b*sin(q2)^2 + (I4b*sin(q4)^2)/2 - L2*L4*m3 - 2*L2*L4*m4 - (L4^2*m3*sin(q2 + q3)^2)/4 - L4^2*m4*sin(q2 + q3)^2 + (L5^2*m4*sin(q2 + q3)^2)/4 + (L3^2*m2*sin(q2)^2)/4 + L3^2*m3*sin(q2)^2 + L3^2*m4*sin(q2)^2 - L3*L5*m4*sin(q3/2)^2 + L2*L5*m4*sin(q2 + q3) + 2*L2*L4*m3*sin(q2/2 + q3/2)^2 + 4*L2*L4*m4*sin(q2/2 + q3/2)^2 + L2*L3*m2*sin(q2) + 2*L2*L3*m3*sin(q2) + 2*L2*L3*m4*sin(q2) + (L3*L4*m3*sin(q3))/2 + L3*L4*m4*sin(q3) - (L3*L4*m3*sin(2*q2 + q3))/2 - L3*L4*m4*sin(2*q2 + q3) - (L4*L5*m4*sin(2*q2 + 2*q3))/2 + L3*L5*m4*sin(q2 + q3/2)^2,                                                                                                                                            -(sin(2*q4)*sin(q2 + q3)*(I4a - I4b))/2,                                                                                                          -(sin(2*q4)*sin(q2 + q3)*(I4a - I4b))/2, I4c*cos(q2 + q3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -(sin(2*q4)*sin(q2 + q3)*(I4a - I4b))/2, I3b + I2c - I4a*(cos(q4)^2 - 1) + (L3^2*m2)/4 + L3^2*m3 + L3^2*m4 + (L4^2*m3)/4 + L4^2*m4 + (L5^2*m4)/4 + I4b*cos(q4)^2 + L3*L5*m4*cos(q3) + L3*L4*m3*sin(q3) + 2*L3*L4*m4*sin(q3), I3b - I4b*(sin(q4)^2 - 1) + (L4^2*m3)/4 + L4^2*m4 + (L5^2*m4)/4 + I4a*sin(q4)^2 + (L3*L5*m4*cos(q3))/2 + (L3*L4*m3*sin(q3))/2 + L3*L4*m4*sin(q3),                0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -(sin(2*q4)*sin(q2 + q3)*(I4a - I4b))/2,                                   I3b - I4b*(sin(q4)^2 - 1) + (L4^2*m3)/4 + L4^2*m4 + (L5^2*m4)/4 + I4a*sin(q4)^2 + (L3*L5*m4*cos(q3))/2 + (L3*L4*m3*sin(q3))/2 + L3*L4*m4*sin(q3),                                                                  I3b - I4a*(cos(q4)^2 - 1) + (L4^2*m3)/4 + L4^2*m4 + (L5^2*m4)/4 + I4b*cos(q4)^2,                0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               I4c*cos(q2 + q3),                                                                                                                                                                                  0,                                                                                                                                                0,              I4c];
 






G =[                                                                                                                              0;
(49*L5*m4*sin(q2 + q3))/10 - (49*L4*m4*cos(q2 + q3))/5 - (49*L4*m3*cos(q2 + q3))/10 + (49*L3*m2*sin(q2))/10 + (49*L3*m3*sin(q2))/5 + (49*L3*m4*sin(q2))/5;
                                                                      (49*L5*m4*sin(q2 + q3))/10 - (49*L4*m4*cos(q2 + q3))/5 - (49*L4*m3*cos(q2 + q3))/10;
                                                                                                                                                        0];     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
C =[(I2b*q_d2*sin(2*q2))/2 - (I4a*q_d4*sin(2*q4))/4 - (I2a*q_d2*sin(2*q2))/2 + (I4b*q_d4*sin(2*q4))/4 + (I4a*q_d2*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4a*q_d2*sin(2*q2 + 2*q3 + 2*q4))/8 + (I4a*q_d3*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4a*q_d3*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4a*q_d4*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4a*q_d4*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4b*q_d2*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4b*q_d2*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4b*q_d3*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4b*q_d3*sin(2*q2 + 2*q3 + 2*q4))/8 + (I4b*q_d4*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4b*q_d4*sin(2*q2 + 2*q3 + 2*q4))/8 + (I3a*q_d2*sin(2*q2 + 2*q3))/2 + (I3a*q_d3*sin(2*q2 + 2*q3))/2 + (I4a*q_d2*sin(2*q2 + 2*q3))/4 + (I4a*q_d3*sin(2*q2 + 2*q3))/4 + (I4b*q_d2*sin(2*q2 + 2*q3))/4 + (I4b*q_d3*sin(2*q2 + 2*q3))/4 - (I3c*q_d2*sin(2*q2 + 2*q3))/2 - (I3c*q_d3*sin(2*q2 + 2*q3))/2 - (I4c*q_d2*sin(2*q2 + 2*q3))/2 - (I4c*q_d3*sin(2*q2 + 2*q3))/2 + (L3^2*m2*q_d2*sin(2*q2))/8 + (L3^2*m3*q_d2*sin(2*q2))/2 + (L3^2*m4*q_d2*sin(2*q2))/2 - (L4^2*m3*q_d2*sin(2*q2 + 2*q3))/8 - (L4^2*m3*q_d3*sin(2*q2 + 2*q3))/8 - (L4^2*m4*q_d2*sin(2*q2 + 2*q3))/2 - (L4^2*m4*q_d3*sin(2*q2 + 2*q3))/2 + (L5^2*m4*q_d2*sin(2*q2 + 2*q3))/8 + (L5^2*m4*q_d3*sin(2*q2 + 2*q3))/8 - (L4*L5*m4*q_d2*cos(2*q2 + 2*q3))/2 - (L4*L5*m4*q_d3*cos(2*q2 + 2*q3))/2 + (L2*L5*m4*q_d2*cos(q2 + q3))/2 + (L2*L5*m4*q_d3*cos(q2 + q3))/2 + (L2*L4*m3*q_d2*sin(q2 + q3))/2 + (L2*L4*m3*q_d3*sin(q2 + q3))/2 + L2*L4*m4*q_d2*sin(q2 + q3) + L2*L4*m4*q_d3*sin(q2 + q3) + (L2*L3*m2*q_d2*cos(q2))/2 + L2*L3*m3*q_d2*cos(q2) + L2*L3*m4*q_d2*cos(q2) + (L3*L4*m3*q_d3*cos(q3))/4 + (L3*L4*m4*q_d3*cos(q3))/2 - (L3*L5*m4*q_d3*sin(q3))/4 - (L3*L4*m3*q_d2*cos(2*q2 + q3))/2 - (L3*L4*m3*q_d3*cos(2*q2 + q3))/4 - L3*L4*m4*q_d2*cos(2*q2 + q3) - (L3*L4*m4*q_d3*cos(2*q2 + q3))/2 + (L3*L5*m4*q_d2*sin(2*q2 + q3))/2 + (L3*L5*m4*q_d3*sin(2*q2 + q3))/4, (I2b*q_d1*sin(2*q2))/2 - (I2a*q_d1*sin(2*q2))/2 + (I4a*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4a*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4b*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4b*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 + (I3a*q_d1*sin(2*q2 + 2*q3))/2 + (I4a*q_d1*sin(2*q2 + 2*q3))/4 + (I4b*q_d1*sin(2*q2 + 2*q3))/4 - (I3c*q_d1*sin(2*q2 + 2*q3))/2 - (I4c*q_d1*sin(2*q2 + 2*q3))/2 + (I4a*q_d2*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d2*sin(q2 + q3 + 2*q4))/4 + (I4a*q_d3*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d3*sin(q2 + q3 + 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 + 2*q4))/4 - (I4b*q_d2*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d2*sin(q2 + q3 + 2*q4))/4 - (I4b*q_d3*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d3*sin(q2 + q3 + 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 + 2*q4))/4 - (I4c*q_d4*sin(q2 + q3))/2 + (L3^2*m2*q_d1*sin(2*q2))/8 + (L3^2*m3*q_d1*sin(2*q2))/2 + (L3^2*m4*q_d1*sin(2*q2))/2 - (L4^2*m3*q_d1*sin(2*q2 + 2*q3))/8 - (L4^2*m4*q_d1*sin(2*q2 + 2*q3))/2 + (L5^2*m4*q_d1*sin(2*q2 + 2*q3))/8 - (L4*L5*m4*q_d1*cos(2*q2 + 2*q3))/2 + (L2*L5*m4*q_d1*cos(q2 + q3))/2 + (L2*L4*m3*q_d1*sin(q2 + q3))/2 + L2*L4*m4*q_d1*sin(q2 + q3) + (L2*L3*m2*q_d1*cos(q2))/2 + L2*L3*m3*q_d1*cos(q2) + L2*L3*m4*q_d1*cos(q2) - (L3*L4*m3*q_d1*cos(2*q2 + q3))/2 - L3*L4*m4*q_d1*cos(2*q2 + q3) + (L3*L5*m4*q_d1*sin(2*q2 + q3))/2, (I4a*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4a*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4b*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4b*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 + (I3a*q_d1*sin(2*q2 + 2*q3))/2 + (I4a*q_d1*sin(2*q2 + 2*q3))/4 + (I4b*q_d1*sin(2*q2 + 2*q3))/4 - (I3c*q_d1*sin(2*q2 + 2*q3))/2 - (I4c*q_d1*sin(2*q2 + 2*q3))/2 + (I4a*q_d2*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d2*sin(q2 + q3 + 2*q4))/4 + (I4a*q_d3*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d3*sin(q2 + q3 + 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 + 2*q4))/4 - (I4b*q_d2*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d2*sin(q2 + q3 + 2*q4))/4 - (I4b*q_d3*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d3*sin(q2 + q3 + 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 + 2*q4))/4 - (I4c*q_d4*sin(q2 + q3))/2 - (L4^2*m3*q_d1*sin(2*q2 + 2*q3))/8 - (L4^2*m4*q_d1*sin(2*q2 + 2*q3))/2 + (L5^2*m4*q_d1*sin(2*q2 + 2*q3))/8 - (L4*L5*m4*q_d1*cos(2*q2 + 2*q3))/2 + (L2*L5*m4*q_d1*cos(q2 + q3))/2 + (L2*L4*m3*q_d1*sin(q2 + q3))/2 + L2*L4*m4*q_d1*sin(q2 + q3) + (L3*L4*m3*q_d1*cos(q3))/4 + (L3*L4*m4*q_d1*cos(q3))/2 - (L3*L5*m4*q_d1*sin(q3))/4 - (L3*L4*m3*q_d1*cos(2*q2 + q3))/4 - (L3*L4*m4*q_d1*cos(2*q2 + q3))/2 + (L3*L5*m4*q_d1*sin(2*q2 + q3))/4, - (q_d2*sin(q2 + q3)*(I4c - I4a*(2*sin(q4)^2 - 1) + I4b*(2*sin(q4)^2 - 1)))/2 - (q_d3*sin(q2 + q3)*(I4c - I4a*(2*sin(q4)^2 - 1) + I4b*(2*sin(q4)^2 - 1)))/2 - 2*q_d1*sin(2*q4)*sin(q2 + q3)^2*(I4a/4 - I4b/4);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (I2a*q_d1*sin(2*q2))/2 - (I2b*q_d1*sin(2*q2))/2 - (I4a*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4a*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 + (I4b*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4b*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 - (I3a*q_d1*sin(2*q2 + 2*q3))/2 - (I4a*q_d1*sin(2*q2 + 2*q3))/4 - (I4b*q_d1*sin(2*q2 + 2*q3))/4 + (I3c*q_d1*sin(2*q2 + 2*q3))/2 + (I4c*q_d1*sin(2*q2 + 2*q3))/2 - (I4a*q_d4*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 + 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 + 2*q4))/4 + (I4c*q_d4*sin(q2 + q3))/2 - (L3^2*m2*q_d1*sin(2*q2))/8 - (L3^2*m3*q_d1*sin(2*q2))/2 - (L3^2*m4*q_d1*sin(2*q2))/2 + (L4^2*m3*q_d1*sin(2*q2 + 2*q3))/8 + (L4^2*m4*q_d1*sin(2*q2 + 2*q3))/2 - (L5^2*m4*q_d1*sin(2*q2 + 2*q3))/8 + (L4*L5*m4*q_d1*cos(2*q2 + 2*q3))/2 - (L2*L5*m4*q_d1*cos(q2 + q3))/2 - (L2*L4*m3*q_d1*sin(q2 + q3))/2 - L2*L4*m4*q_d1*sin(q2 + q3) - (L2*L3*m2*q_d1*cos(q2))/2 - L2*L3*m3*q_d1*cos(q2) - L2*L3*m4*q_d1*cos(q2) + (L3*L4*m3*q_d1*cos(2*q2 + q3))/2 + L3*L4*m4*q_d1*cos(2*q2 + q3) - (L3*L5*m4*q_d1*sin(2*q2 + q3))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                q_d4*((I4a*sin(2*q4))/2 - (I4b*sin(2*q4))/2) + q_d3*((L3*L4*m3*cos(q3))/2 + L3*L4*m4*cos(q3) - (L3*L5*m4*sin(q3))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           q_d4*((I4a*sin(2*q4))/2 - (I4b*sin(2*q4))/2) + q_d2*((L3*L4*m3*cos(q3))/2 + L3*L4*m4*cos(q3) - (L3*L5*m4*sin(q3))/2) + q_d3*((L3*L4*m3*cos(q3))/2 + L3*L4*m4*cos(q3) - (L3*L5*m4*sin(q3))/2),                                                                                 q_d2*sin(2*q4)*(I4a/2 - I4b/2) + q_d3*sin(2*q4)*(I4a/2 - I4b/2) + (q_d1*sin(q2 + q3)*(I4c - I4a*cos(2*q4) + I4b*cos(2*q4)))/2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (I4b*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 - (I4a*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 - (I4a*q_d1*sin(2*q2 + 2*q3 - 2*q4))/8 + (I4b*q_d1*sin(2*q2 + 2*q3 + 2*q4))/8 - (I3a*q_d1*sin(2*q2 + 2*q3))/2 - (I4a*q_d1*sin(2*q2 + 2*q3))/4 - (I4b*q_d1*sin(2*q2 + 2*q3))/4 + (I3c*q_d1*sin(2*q2 + 2*q3))/2 + (I4c*q_d1*sin(2*q2 + 2*q3))/2 - (I4a*q_d4*sin(q2 + q3 - 2*q4))/4 - (I4a*q_d4*sin(q2 + q3 + 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 - 2*q4))/4 + (I4b*q_d4*sin(q2 + q3 + 2*q4))/4 + (I4c*q_d4*sin(q2 + q3))/2 + (L4^2*m3*q_d1*sin(2*q2 + 2*q3))/8 + (L4^2*m4*q_d1*sin(2*q2 + 2*q3))/2 - (L5^2*m4*q_d1*sin(2*q2 + 2*q3))/8 + (L4*L5*m4*q_d1*cos(2*q2 + 2*q3))/2 - (L2*L5*m4*q_d1*cos(q2 + q3))/2 - (L2*L4*m3*q_d1*sin(q2 + q3))/2 - L2*L4*m4*q_d1*sin(q2 + q3) - (L3*L4*m3*q_d1*cos(q3))/4 - (L3*L4*m4*q_d1*cos(q3))/2 + (L3*L5*m4*q_d1*sin(q3))/4 + (L3*L4*m3*q_d1*cos(2*q2 + q3))/4 + (L3*L4*m4*q_d1*cos(2*q2 + q3))/2 - (L3*L5*m4*q_d1*sin(2*q2 + q3))/4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                q_d4*((I4a*sin(2*q4))/2 - (I4b*sin(2*q4))/2) - q_d2*((L3*L4*m3*cos(q3))/2 + L3*L4*m4*cos(q3) - (L3*L5*m4*sin(q3))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (q_d4*sin(2*q4)*(I4a - I4b))/2,                                                                                 q_d2*sin(2*q4)*(I4a/2 - I4b/2) + q_d3*sin(2*q4)*(I4a/2 - I4b/2) + (q_d1*sin(q2 + q3)*(I4c - I4a*cos(2*q4) + I4b*cos(2*q4)))/2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2*q_d1*sin(2*q4)*sin(q2 + q3)^2*(I4a/4 - I4b/4) - (q_d3*sin(q2 + q3)*(I4c + I4a*(2*sin(q4)^2 - 1) - I4b*(2*sin(q4)^2 - 1)))/2 - (q_d2*sin(q2 + q3)*(I4c + I4a*(2*sin(q4)^2 - 1) - I4b*(2*sin(q4)^2 - 1)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     - (q_d2*sin(2*q4)*(I4a - I4b))/2 - (q_d3*sin(2*q4)*(I4a - I4b))/2 - (q_d1*sin(q2 + q3)*(I4c - I4a*cos(2*q4) + I4b*cos(2*q4)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - (q_d2*sin(2*q4)*(I4a - I4b))/2 - (q_d3*sin(2*q4)*(I4a - I4b))/2 - (q_d1*sin(q2 + q3)*(I4c - I4a*cos(2*q4) + I4b*cos(2*q4)))/2,                                                                                                                                                                                                             0];
 



Dz= -inv(M)*C*Z-inv(M)*G+inv(M)*tau-0.8*eye(4,4)*Z;% -inv(M)* Jaa'*F  

dy(1,1)=Dz(1);
dy(2,1)=Dz(2);
dy(3,1)=Dz(3);
dy(4,1)=Dz(4);




dy(5,1)=q_d1;
dy(6,1)=q_d2;
dy(7,1)=q_d3;
dy(8,1)=q_d4;
dy(9,1)=0;
dy(10,1)=0;
dy(11,1)=0;
dy(12,1)=0;

     
     
end










